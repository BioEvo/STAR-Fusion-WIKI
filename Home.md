# STAR-Fusion 

STAR-Fusion is a component of the [Trinity Cancer Transcriptome Analysis Toolkit (CTAT)](https://github.com/NCIP/Trinity_CTAT/wiki). STAR-Fusion uses the [STAR](https://github.com/alexdobin/STAR) aligner to identify candidate fusion transcripts supported by Illumina reads.  STAR-Fusion further processes the output generated by the STAR aligner to map junction reads and spanning reads to a reference annotation set.

>Our STAR-Fusion manuscript preprint is now available on bioRxiv <http://biorxiv.org/content/early/2017/03/24/120295>

## Installation

Type 'make' in the base installation directory.

In addition to STAR-Fusion, the following tools and resource data sets must be installed:

### Downloading a STAR-Fusion Release (**Preferred**)

Visit <https://github.com/STAR-Fusion/STAR-Fusion/releases>

and be sure to download the 'FULL' version.  The others are auto-generated by GitHub and are missing required submodules.

### Installing from GitHub Clone:

(Bleeding-edge code, **not** preferred)

    %  git clone --recursive https://github.com/STAR-Fusion/STAR-Fusion.git

The --recursive parameter is needed to integrate the required submodules.  Active development currently happens off the 'master' branch.  

Please consider using a proper 'FULL' release version as described above.


### Tools Required:

*  STAR <https://github.com/alexdobin/STAR>
*  possibly some non-standard Perl modules - see below:
  
.

       A typical perl module installation may involve:
       perl -MCPAN -e shell
       install DB_File
       install URI::Escape
       install Set::IntervalTree
       install Carp::Assert
       install JSON::XS
       install PerlIO::gzip

<a name='ComputeRequirements'></a>
## Computing / Hardware requirements

If you're planning to run STAR to align reads to the human genome, then you'll need ~30G RAM.   If you've already run STAR and are just planning on running STAR-Fusion given the existing STAR outputs, then modest resources are required and it should run on any commodity hardware.


### Data Resources Required:

A reference genome and corresponding protein-coding gene annotation set, including blast-matching gene pairs must be provided to STAR-Fusion.  We provide several alternative resources for human fusion transcript detection depending on whether you want to use GRCh37 or GRCh38 reference human genomes and corresponding Gencode annotation sets.  Options are available here: <https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/>, so choose one, and below we refer to it as 'CTAT_resource_lib.tar.gz'.   The gene annotations in each case are restricted to the protein-coding and lincRNA transcripts.


If you're looking to apply STAR-Fusion using a different target, you'll need to generate the required resources as described by our [FusionFilter](http://FusionFilter.github.io) resource builder.  FusionFilter comes included in the STAR-Fusion software.


## Preparing the genome resource lib

If you downloaded the large (30G) 'plug-n-play' resource lib, then just untar/gz the archive and use it directly. 

Otherwise, if you downloaded the small (~2G) unprocessed resource lib, then you'll need to prep it for use with STAR-fusion as follows: 

     %  tar xvf CTAT_resource_lib.tar.gz

     %  cd CTAT_resource_lib/

     %  $STAR_FUSION_HOME/FusionFilter/prep_genome_lib.pl \
                             --genome_fa ref_genome.fa \
                             --gtf ref_annot.gtf \
                             --blast_pairs blast_pairs.outfmt6.gz \
                             --fusion_annot_lib fusion_lib.dat.gz

    %  $STAR_FUSION_HOME/FusionFilter/util/index_pfam_domain_info.pl  \
            --pfam_domains PFAM.domtblout.dat.gz \
            --genome_lib_dir ctat_genome_lib_build_dir


Once the build process completes successfully, you can then refer to the above like so with STAR-Fusion:

       STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib   ...

       # full usage info provided below.


<a name='RunnningStarF'></a>
<a name='RunFromFastq'></a>
## Running STAR-Fusion starting with FASTQ files:

Given paired-end of FASTQ files, run STAR-Fusion like so:

     STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib \
                 --left_fq reads_1.fq \
                 --right_fq reads_2.fq \
                 --output_dir star_fusion_outdir
                 
If you have single-end FASTQ files, just use the --left_fq parameter:

     STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib \
                 --left_fq reads_1.fq \ 
                 --output_dir star_fusion_outdir

>Note, unless you have relatively long single-end reads (ex. at least 100 base length), you will be underpowered for detecting fusion transcripts.

<a name='KickstartMode'></a>
## Alternatively, Kickstart mode: running STAR yourself, and then running STAR-Fusion using the existing outputs

It's not always the case that you want to have STAR-Fusion run STAR directly, as you may have already run STAR earlier on, or prefer to run STAR separately to use the outputs in other processes such as for expression estimates or variant detection.

Parameters that we recommend for running STAR as part of STAR-Fusion are as follows:

     STAR --genomeDir ${star_index_dir} \                                                                                     
          --readFilesIn ${left_fq_filename} ${right_fq_filename} \                                                                      
          --twopassMode Basic \                                                                                                      
          --outReadsUnmapped None \                                                                                                  
          --chimSegmentMin 12 \                                                                                                    
          --chimJunctionOverhangMin 12 \                                                                                           
          --alignSJDBoverhangMin 10 \                                                                                              
          --alignMatesGapMax 100000 \                                                                                             
          --alignIntronMax 100000 \                                                                                                
          --chimSegmentReadGapMax parameter 3 \                                                                                    
          --alignSJstitchMismatchNmax 5 -1 5 5 \
          --runThreadN ${THREAD_COUNT} \                                                                                                           
          --limitBAMsortRAM 31532137230 \                                                                                           
          --outSAMtype BAM SortedByCoordinate 

This will (in part) generate a file called 'Chimeric.out.junction', which is used by STAR-Fusion like so:

     STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib \
                 -J Chimeric.out.junction \
                 --output_dir star_fusion_outdir

>Note, include the --left_fq and --right_fq parameters along with the -J Chimeric.out.junction in order to compute the FFPM (normalized fusion fragments per million total rna-seq fragments) values in your summary report. Otherwise, you'll just get evidence fragment counts without the normalized values.

<a name='Outputs'></a>
## Output from STAR-Fusion

The output from STAR-Fusion is found as a tab-delimited file named 'star-fusion.fusion_predictions.tsv', along with an abridged version that excludes the identification of the evidence fusion reads and called 'star-fusion.fusion_predictions.tsv', with the following format:

```
#FusionName     JunctionReadCount       SpanningFragCount       SpliceType      LeftGene        LeftBreakpoint  RightGene       RightBreakpoint LargeAnchorSupport      LeftBreakDinuc  LeftBreakEntropy        RightBreakDinuc RightBreakEntropy       FFPM
THRA--THRA1/BTR 27      93      ONLY_REF_SPLICE THRA^ENSG00000126351.12 chr17:40086853:+        THRA1/BTR^ENSG00000235300.4     chr17:48294347:+        YES_LDAS        GT      1.8892  AG      1.9656  23875.8456
THRA--THRA1/BTR 5       93      ONLY_REF_SPLICE THRA^ENSG00000126351.12 chr17:40086853:+        THRA1/BTR^ENSG00000235300.4     chr17:48307331:+        YES_LDAS        GT      1.8892  AG      1.4295  19498.6072
ACACA--STAC2    12      52      ONLY_REF_SPLICE ACACA^ENSG00000278540.4 chr17:37122531:-        STAC2^ENSG00000141750.6 chr17:39218173:-        YES_LDAS        GT      1.9656  AG      1.9656  12733.7844
RPS6KB1--SNF8   10      43      ONLY_REF_SPLICE RPS6KB1^ENSG00000108443.13      chr17:59893325:+        SNF8^ENSG00000159210.9  chr17:48943975:-        YES_LDAS        GT      1.3753  AG      1.8323  10545.1651
TOB1--SYNRG     8       30      ONLY_REF_SPLICE TOB1^ENSG00000141232.4  chr17:50866058:-        SYNRG^ENSG00000275066.4 chr17:37520648:-        YES_LDAS        GT      1.4566  AG      1.8892  7560.6844
VAPB--IKZF3     4       46      ONLY_REF_SPLICE VAPB^ENSG00000124164.15 chr20:58389517:+        IKZF3^ENSG00000161405.16        chr17:39777767:-        YES_LDAS        GT      1.9656  AG      1.7819  9948.269
ZMYND8--CEP250  2       44      ONLY_REF_SPLICE ZMYND8^ENSG00000101040.19       chr20:47224317:-        CEP250^ENSG00000126001.15       chr20:35490637:+        NO_LDAS GT      1.8295  AG      1.8062  9152.4075

```

The JunctionReads column indicates the number of RNA-Seq fragments containing a read that aligns as a split read at the site of the putative fusion junction.   

The SpanningFrags column indicates the number of RNA-Seq fragments that encompass the fusion junction such that one read of the pair aligns to a different gene than the other paired-end read of that fragment.

>Those predictions that have very few JunctionReads and SpanningReads are going to be enriched for false positives. Note, depending on the site of the fusion breakpoint and length of the reads, it may not be possible to have SpanningFragments and all evidence may show up in the form of JunctionReads.

Since the number of fusion-supporting reads depends on both the expression of the fusion transcript and the number of reads sequenced, we provide normalized measures of the split reads and spanning fragments as FFPM (fusion fragments per million total reads) measures:  J_FFPM for the junction/split reads and S_FFPM for the spanning fragments.  If you sum them (a column not yet included but will be soon), you can filter based on this value to remove many lowly expressed and likely artifact fusions.  A filter of 0.1 sum FFPM tends to be very effective.

The 'LargeAnchorSupport' column indicates whether there are split reads that provide 'long' (set to length of 25 bases) alignments on both sides of the putative breakpoint.  Those fusions supported only by split reads (no spanning fragments) and lack LargeAnchorSupport are often highly suspicious and tend to be false positives.  Those with LargeAnchorSupport are labeled as 'YES_LDAS' (where LDAS = long double anchor support.... yes, more jargon).

'SpliceType' indicates whether the proposed breakpoint occurs at reference exon junctions as provided by the reference transcript structure annotations (ex. gencode).

The .final.abridged.FFPM output file contents are shown above. See the unabridged '.final' output file for the identity of the RNA-Seq fragments identified as junction or spanning fragments.

If there are alternatively spliced isoforms for fusion transcripts, the same fusion pair will be listed as multiple entries but with different breakpoints identified.


<a name='InspectionValidation'></a>
## Further Inspection, Visualization, and Validation?

We have a companion tool called [FusionInspector](<https://github.com/FusionInspector/FusionInspector/wiki>) that provides a more in-depth view of the evidence supporting the predicted fusions.  FusionInspector can also run [Trinity](http://trinityrnaseq.github.io) to de novo reconstruct your predicted fusion transcripts based on the identified fusion-supporting RNA-Seq reads.

>As of STAR-Fusion v1.1.0, FusionInspector is integrated into STAR-Fusion as a submodule.  

FusionInspector can be run in either 'inspect' or 'validate' mode when executed downstream from STAR-Fusion:

*  '**--FusionInspector inspect**': only the reads identified by STAR-Fusion as evidence supporting the fusion prediction are aligned directly to a target set of fusion-gene contigs for exploration using IGV.

*  '**--FusionInspector validate**': involves a more rigorous process of reevaluating the entire set of input reads, aligning the reads to a combination of the reference genome and a set of fusion-gene contigs based on the STAR-Fusion predictions. Reads mapping better to the fusion-gene contigs than the reference genome are identified and reported, fusions are re-scored/quantified, and fusion transcript allelic fractions are computed.

If either mode is invoked, STAR-Fusion will run FusionInspector and create a FusionInspector/ output subdirectory containing all relevant output files.  See the [FusionInspector Wiki]( <https://github.com/FusionInspector/FusionInspector/wiki>) for documentation on output files and loading results into IGV for visualization. 


<a name='FusionAnnotation'></a>
## Annotation of Fusion Transcripts

Fusion transcript identification and analysis is a very active area of cancer research and there are many resources providing lists of known fusion transcripts.  Some of the most relevant resources include:

* [Mitelman Database](https://cgap.nci.nih.gov/Chromosomes/Mitelman)
* [Cosmic](http://cancer.sanger.ac.uk/cosmic/fusion)
* [ChimerDB](http://203.255.191.229:8080/chimerdbv31/mindex.cdb)

and there have been large-scale studies of fusion transcripts across cancer types, including publications with supplementary data identifying fusion transcripts, including:

* [Yoshihara et al.  The landscape and therapeutic relevance of cancer-associated transcript fusions. 2015. Oncogene. 2015 Sep 10;34(37):4845-54. doi: 10.1038/onc.2014.406.](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4468049/)
* [Klijn et al. A comprehensive transcriptional portrait of human cancer cell lines. Nat Biotechnol. 2015 Mar;33(3):306-12. doi: 10.1038/nbt.3080.](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4468049/)

as well as other attributes of pairs of genes that may be of interest, such as 

* [Duplicated Genes Database](http://dgd.genouest.org/)

or fusion pairs that tend to show up recurrently in normal tissues such as RNA-Seq samples released as part of the [GTEx project](https://www.gtexportal.org/home/).

In STAR-Fusion, we bundle our [FusionAnnotator](https://github.com/FusionAnnotator/FusionAnnotator/wiki) utility, and in the [CTAT Genome Lib](https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/), we incorporate our fusion transcript annotation library [CTAT_HumanFusionLib](https://github.com/FusionAnnotator/CTAT_HumanFusionLib/wiki).

Fusion annotations are included in the STAR-Fusion output file when the '--annotate' option is invoked, and tacked on as an additional annotation column in the final report.  Example fusion annotations might look like so:



    BCR--ABL1	BCR->ArcherDX_panel,FoundationOne_panel,breakpoint_cluster_region,ABL1->ABL_proto-oncogene_1,_non-receptor_tyrosine_kinase,FoundationOne_panel,OncocartaV1_panel,OncomapV4_panel,Cosmic{samples=5990,mutations=5142,papers=196},Mitelman{MDS_NOS=2,ALL=5,Nonneo_hemat=2,AUL=2,DLBL=2,AML=14,Heart=7,AL_bi=2,Skin=2,MM=2,CML_ab_t=291,BL=2,RA=2},chimerdb_omim:{AcuteLymphocyticLeukemia},chimerdb_omim:{ChronicMyelogenousLeukemia},chimerdb_pubmed{Chronic myelogenous leukaemia (CML),Chronic myelogeneous leukaemia (CML),acute myelogenous leukemia (AML),chronic myeloid leukemia(CML),chronic myeloid leukemias (CML),Philadelphia positive leukaemia,acute lymphoblastic leukemia(ALL),K562,chronic neutrophilic leukemia and multiple myeloma (IgG kappa),Leukemia,chronic lymphocytic leukemia,acute myeloid leukemia(AML),Chronic myelogenous leukemia (CML),"acute lymphoblastic leukemia (ALL), Chronic myelogeneous leukaemia (CML)",myelodysplastic syndromes (MDS),Philadelphiapositive chronic myelogenous leukemia ,chronic myelomonocytic leukemia,chronic myelogenous leukemia(CML),"CML, ALL",Philadelphianegative chronic myeloid leukaemia,severalleukaemia,B cell precursor leukemia cells,Tcell acute lymphoblastic leukemia (TALL),"chronic granulocytic leukaemiam, chronic myeloid leukaemias, acute myeloid leukaemia",acute lymphoblastic leukemia.,"chronic myeloid leukemia (CML), acute lymphoblastic leukemia(APL)",chronic myeloid leukemia (CML),"chronic myeloid leukemia (CML), acute lymphoblastic leukemia (ALL), acute myeloid leukemia(AML), myeloproliferative disorder (MPD)",Chronic myelogenous leukemia (CML) acute lymphoblastic leukemias (ALL),chronic myeloid leukaemia,childhood acute lymphoblastic leukemia,Chronic myelogenous leukemia (CML) ,"chronic myeloid leukaemia (CML), ALL and AML",chronic myeloid leukaemia(CML),Chronic myeloid leukemia (CML),"chronic myelocytic leukaemia, acute lymphoblastic leukaemia","chronic myeloid leukemia (CML), acute myeloid leukemia (AML)","Tcell acute lymphoblastic leukemia, acute myelomonocytic leukemia",chronic myelogenous leukaemia (CML),"chronic myelogenous leukemia(CML), acute lymphoblastic leukemia(ALL)",Chronic Myeloid Leukaemia (CML),childhood ALL,"PreB acute lymphoblastic leukemia(ALL), positive chronic myelogenous leukemia (CML)",chronic myelogenous leukemia (CML),"chronic myelogenous leukemia (CML), acute myeloid leukemia (AML)",CML,chronic myeloid leukemia ,acute leukemia,adult acute lymphoblastic leukemia(ALL),leukemia,Chronic myeloid leukemia (CML) ,"chronic myelogenous leukemia (CML),myelodysplastic syndromes (MDS),acute myelogenous leukemia(AML)","erythroleukemia, chronic myeloid leukemia (CML)",acute B lymphocytic leukemia,acute undifferentiated leukemia (AUL),acute lymphoblastic leukemia,"chronic myeloid leukemia (CML), Ph+ ALL",Philadelphia chromosome (Ph) positive Chronic myeloid leukaemia (CML),"Philadelphia chromosomenegative (Ph()) nonHodgkin's lymphomas (NHLs), Phpositive (Ph(+)) chronic myelogenous leukemia (CML)",chronic granulocytic leukemia,chronic myelogenous leukemia,Chronic myeloid leukemia(CML),chronic myeloid leukaemia (CML),"chronic myeloid leukemia (CML), acute lymphoblastic leukemia (ALL)","acute lymphoblastic leukemia(ALL), chronic myeloid leukemia (CML), biphenotypic leukemia","chronic myelogenous leukemia (CML), acute lymphoblastic leukemia (ALL)",Philadelphia chromosomepositive leukemias,"chronic myeloid leukemia(CML), acute lymphoblastic leukemia (ALL)",Acute lymphoblastic leukemia (ALL),thrombocythemia,Philadelphia (Ph)positive acute lymphoblastic leukemia (ALL),Chronic myeloid leukaemia (CML),chronic myeloid leukemia,acute lymphoblastic leukemia (ALL),two Ph chromosome positive chronic myelogenous leukemia,Chronic Myeloid Leukemia (CML),Chronic myeloid leukemia,chronic myelocytic leukemia (CML),acute nonlymphocytic leukaemia (ANLL),Chronic myelogenous leukemia,"chronic myelogenous leukemia(CML), mediastinal tumor",Blineage acute lymphoblastic leukemia(Blineage ALL),leukemogenesis,Acute leukaemia,leukemic cells ,"chronic myelogenous leukaemia(CML), Ewing's sarcoma","chronic myeloid leukemia, acute lymphoblastic leukemia",Chronic myelogenous leukemia(CML)},{Klijn_CCL:Lymphoid=4},INTERCHROMOSOMAL[chr22--chr9]
    ACTB--ACTG1	ACTB->actin,_beta,ACTG1->actin_gamma_1,INTERCHROMOSOMAL[chr7--chr17]
    ZFP91--RAB6A	ZFP91->ZFP91_zinc_finger_protein,RAB6A->RAB6A,_member_RAS_oncogene_family,YOSHIHARA_TCGA_num_samples[BRCA:9],INTRACHROMOSOMAL[chr11:15.00Mb]
    ABCB9--ARL6IP4	ABCB9->ATP_binding_cassette_subfamily_B_member_9,ARL6IP4->ADP_ribosylation_factor_like_GTPase_6_interacting_protein_4,INTRACHROMOSOMAL[chr12:0.00Mb],NEIGHBORS_OVERLAP:-:+:[1589]
    KMT2A--EPS15	KMT2A->ArcherDX_panel,FoundationOne_panel,lysine_methyltransferase_2A,EPS15->epidermal_growth_factor_receptor_pathway_substrate_15,Cosmic{samples=131,mutations=9,papers=14},Mitelman{AL_bi=2,ALL=2,AML=7},INTERCHROMOSOMAL[chr11--chr1]
    PRMT1--AURKB	PRMT1->protein_arginine_methyltransferase_1,AURKB->ArcherDX_panel,FoundationOne_panel,aurora_kinase_B,INTERCHROMOSOMAL[chr19--chr17]
    ZNF580--ZNF510	ZNF580->zinc_finger_protein_580,ZNF510->zinc_finger_protein_510,HGNC_GENEFAM,INTERCHROMOSOMAL[chr19--chr9]
    ETV6--ABL2	ETV6->ArcherDX_panel,ETS_variant_6,FoundationOne_panel,ABL2->ABL_proto-oncogene_2,_non-receptor_tyrosine_kinase,ArcherDX_panel,FoundationOne_panel,chimerdb_omim:{acutemyeloblasticleukemiawithmorphologyM3cellline},INTERCHROMOSOMAL[chr12--chr1]
    EML4--ALK	EML4->echinoderm_microtubule_associated_protein_like_4,ALK->ArcherDX_panel,FoundationOne_panel,anaplastic_lymphoma_receptor_tyrosine_kinase,Cosmic{samples=10751,mutations=680,papers=477},YOSHIHARA_TCGA_num_samples[LUAD:4|THCA:1],chimerdb_pubmed{nonsmallcell lung cancer (NSCLC),nonsmall cell lung cancers (NSCLC),lung cancer,nonsmall cell lung cancer (NSCLC),lung cancers,nonsmall cell lung carcinoma,nonsmallcell lung cancers (NSCLC)},{Klijn_CCL:Lung=1},INTRACHROMOSOMAL[chr2:12.25Mb]
    EWSR1--ATF1	EWSR1->EWS_RNA_binding_protein_1,ATF1->activating_transcription_factor_1,Cosmic{samples=355,mutations=179,papers=40},Mitelman{SA_clear=4},INTERCHROMOSOMAL[chr22--chr12]
    EWSR1--FLI1	EWSR1->EWS_RNA_binding_protein_1,FLI1->Fli-1_proto-oncogene,_ETS_transcription_factor,Cosmic{samples=2132,mutations=1332,papers=162},Mitelman{SA_Ewing=14},{Klijn_CCL:Sarcomatoid=3},INTERCHROMOSOMAL[chr22--chr11]
    TMPRSS2--ETV1	TMPRSS2->ArcherDX_panel,FoundationOne_panel,transmembrane_protease,_serine_2,ETV1->ArcherDX_panel,ETS_variant_1,FoundationOne_panel,Cosmic{samples=1078,mutations=21,papers=33},chimerdb_pubmed{prostate cancer,prostate carcinomas},INTERCHROMOSOMAL[chr21--chr7]
    ETV6--NTRK3	ETV6->ArcherDX_panel,ETS_variant_6,FoundationOne_panel,NTRK3->ArcherDX_panel,FoundationOne_panel,neurotrophic_receptor_tyrosine_kinase_3,Cosmic{samples=1050,mutations=144,papers=44},YOSHIHARA_TCGA_num_samples[BRCA:1|SKCM:1|THCA:6],chimerdb_omim:{ongenitalfibrosarcoma},chimerdb_pubmed{certain pediatric tumor,Secretory carcinomas,"AML, Mesoblastic nephroma","Congenital fibrosarcoma (CFS), adulttype fibrosarcoma (ATFS)",synovial sarcoma,congenital mesoblastic nephromas (CMNs),myelodysplastic syndrome (MDS),secretory breast cancer,Secretory breast carcinoma,secretory breast carcinoma,congenital fibrosarcoma,synovial sarcomas,"Secretory carcinomas (SBC), invasive ductal carcinoma",DanaFarber Cancer,soft tissue tumours },INTERCHROMOSOMAL[chr12--chr15]
    CD74--ROS1	CD74->CD74_molecule,ROS1->ArcherDX_panel,FoundationOne_panel,ROS_proto-oncogene_1,_receptor_tyrosine_kinase,Cosmic{samples=1571,mutations=38,papers=46},chimerdb_pubmed{Lung Cancer},{Klijn_CCL:Breast=1},INTERCHROMOSOMAL[chr5--chr6]
    HOOK3--RET	HOOK3->hook_microtubule-tethering_protein_3,RET->ArcherDX_panel,FoundationOne_panel,OncocartaV1_panel,OncomapV4_panel,ret_proto-oncogene,Cosmic{samples=55,mutations=1,papers=6},INTERCHROMOSOMAL[chr8--chr10]
    BRD4--NUTM1	BRD4->ArcherDX_panel,FoundationOne_panel,bromodomain_containing_4,NUTM1->NUT_midline_carcinoma_family_member_1,Cosmic{samples=174,mutations=19,papers=13},INTERCHROMOSOMAL[chr19--chr15]
    AKAP9--BRAF	AKAP9->A-kinase_anchoring_protein_9,BRAF->ArcherDX_panel,B-Raf_proto-oncogene,_serine/threonine_kinase,FoundationOne_panel,OncocartaV1_panel,OncomapV4_panel,Cosmic{samples=292,mutations=4,papers=10},chimerdb_pubmed{Thyroid carcinoma},INTRACHROMOSOMAL[chr7:48.68Mb]
    BRD4--NUTM1	BRD4->ArcherDX_panel,FoundationOne_panel,bromodomain_containing_4,NUTM1->NUT_midline_carcinoma_family_member_1,Cosmic{samples=174,mutations=19,papers=13},INTERCHROMOSOMAL[chr19--chr15]
    FGFR3--TACC3	FGFR3->ArcherDX_panel,FoundationOne_panel,OncocartaV1_panel,OncomapV4_panel,fibroblast_growth_factor_receptor_3,TACC3->transforming_acidic_coiled-coil_containing_protein_3,Cosmic{samples=250,mutations=14,papers=8},YOSHIHARA_TCGA_num_samples[BLCA:3|GBM:5|HNSC:2|LGG:1|LUSC:4],{Klijn_CCL:Urinary_Bladder=1,Liver=1},INTRACHROMOSOMAL[chr4:0.05Mb],LOCAL_REARRANGEMENT:+:[48136]
    FIP1L1--PDGFRA	FIP1L1->factor_interacting_with_PAPOLA_and_CPSF1,PDGFRA->ArcherDX_panel,FoundationOne_panel,OncomapV4_panel,platelet_derived_growth_factor_receptor_alpha,Mitelman{ALL=1},chimerdb_pubmed{"chronic eosinophilic leukemia(CEL), Systemic mastocytosis (SM)",eosinophiliaassociated myeloproliferative disorders (EosMPD),Chronic eosinophilic leukemia,Systemic mastocytosis (SM),chronic myeloid leukemia (CML),chronic myeloid leukemia,Chronic eosinophilic leukemia (CEL),Hypereosinophilic syndrome,leukemia,chronic eosinophilic leukemia(CEL),eosinophiliaassociated myeloproliferative neoplasms,idiopathic hypereosinophilia,acute myeloid leukemia (AML),"idiopathic hypereosinophilic syndrome, chronic eosinophilic leukemia",Idiopathic hypereosinophilic syndrome  and chronic eosinophilia leukemia,myelodysplastic syndromes (MDS),hypereosinophilic syndrome,Idiopathic hypereosinophilic syndrome (HES),lymphomatoid papulosis (LyP),chronic eosinophilic leukemia},INTRACHROMOSOMAL[chr4:0.77Mb]
    GOPC--ROS1	GOPC->golgi-associated_PDZ_and_coiled-coil_motif_containing,ROS1->ArcherDX_panel,FoundationOne_panel,ROS_proto-oncogene_1,_receptor_tyrosine_kinase,Cosmic{samples=242,mutations=7,papers=15},Mitelman{Astcyt_III-IV=1},chimerdb_pubmed{astrocytoma},INTRACHROMOSOMAL[chr6:0.13Mb]
    PDE6B--PPP2R2D	PDE6B->phosphodiesterase_6B,PPP2R2D->protein_phosphatase_2_regulatory_subunit_B,_delta,GTEx_Recurrent:{Brain=[count:3=pct:0.4],Pancreas=[count:2=pct:1.1],Spleen=[count:1=pct:0.9],Lung=[count:1=pct:0.6],Prostate=[count:1=pct:1.6],Esophagus=[count:1=pct:0.2]},INTERCHROMOSOMAL[chr4--chr10]
    NCOR2--UBC	NCOR2->nuclear_receptor_corepressor_2,UBC->ubiquitin_C,GTEx_Recurrent:{Muscle=[count:53=pct:22.5],Esophagus=[count:44=pct:10.8],Skin=[count:33=pct:10.3],Blood_Vessel=[count:27=pct:7.3],Blood=[count:23=pct:13.2],Whole_Blood=[count:23=pct:17.4],Adipose_Tissue=[count:20=pct:6.7],Lung=[count:17=pct:10.2],Colon=[count:16=pct:8.4],Heart=[count:11=pct:4.3],Brain=[count:10=pct:1.5],Breast=[count:6=pct:5.4],Salivary_Gland=[count:5=pct:12.8],Stomach=[count:3=pct:3.4],Uterus=[count:3=pct:7.0],Liver=[count:3=pct:2.4],Bladder=[count:2=pct:22.2],Pituitary=[count:2=pct:3.8],Thyroid=[count:2=pct:1.1],Spleen=[count:2=pct:1.8],Prostate=[count:2=pct:3.3],Nerve=[count:1=pct:0.6],Adrenal_Gland=[count:1=pct:1.2],Small_Intestine=[count:1=pct:1.8],Ovary=[count:1=pct:1.9],Pancreas=[count:1=pct:0.6]},INTRACHROMOSOMAL[chr12:0.34Mb]
    KANSL1--ARL17B	KANSL1->KAT8_regulatory_NSL_complex_subunit_1,ARL17B->ADP_ribosylation_factor_like_GTPase_17B,GTEx_Recurrent:{Brain=[count:234=pct:34.7],Esophagus=[count:134=pct:33.0],Blood_Vessel=[count:116=pct:31.4],Adipose_Tissue=[count:103=pct:34.4],Skin=[count:103=pct:32.1],Heart=[count:75=pct:29.5],Muscle=[count:72=pct:30.5],Nerve=[count:64=pct:36.8],Thyroid=[count:58=pct:32.4],Colon=[count:57=pct:29.8],Blood=[count:54=pct:31.0],Lung=[count:53=pct:31.7],Whole_Blood=[count:45=pct:34.1],Pancreas=[count:43=pct:23.8],Breast=[count:38=pct:34.2],Liver=[count:36=pct:28.6],Testis=[count:34=pct:32.4],Spleen=[count:34=pct:30.4],Adrenal_Gland=[count:27=pct:31.8],Stomach=[count:26=pct:29.2],Vagina=[count:24=pct:43.6],Ovary=[count:23=pct:43.4],Prostate=[count:22=pct:36.1],Pituitary=[count:17=pct:32.7],Uterus=[count:16=pct:37.2],Small_Intestine=[count:16=pct:29.1],Salivary_Gland=[count:14=pct:35.9],Kidney=[count:5=pct:33.3],Cervix_Uteri=[count:4=pct:50.0],Bladder=[count:3=pct:33.3],Fallopian_Tube=[count:2=pct:33.3]},INTRACHROMOSOMAL[chr17:0.05Mb],LOCAL_REARRANGEMENT:-:[49417]
    KANSL1--ARL17A	KANSL1->KAT8_regulatory_NSL_complex_subunit_1,ARL17A->ADP_ribosylation_factor_like_GTPase_17A,GTEx_Recurrent:{Brain=[count:13=pct:1.9],Heart=[count:9=pct:3.5],Esophagus=[count:6=pct:1.5],Adipose_Tissue=[count:5=pct:1.7],Blood_Vessel=[count:3=pct:0.8],Skin=[count:3=pct:0.9],Pancreas=[count:3=pct:1.7],Blood=[count:2=pct:1.1],Stomach=[count:2=pct:2.2],Liver=[count:2=pct:1.6],Spleen=[count:1=pct:0.9],Colon=[count:1=pct:0.5],Whole_Blood=[count:1=pct:0.8],Vagina=[count:1=pct:1.8],Adrenal_Gland=[count:1=pct:1.2],Muscle=[count:1=pct:0.4],Testis=[count:1=pct:1.0],Lung=[count:1=pct:0.6],Thyroid=[count:1=pct:0.6],Salivary_Gland=[count:1=pct:2.6]},INTRACHROMOSOMAL[chr17:0.29Mb]
    C15orf57--CBX3	C15orf57->chromosome_15_open_reading_frame_57,CBX3->chromobox_3,GTEx_Recurrent:{Muscle=[count:83=pct:35.2],Blood_Vessel=[count:74=pct:20.0],Adipose_Tissue=[count:59=pct:19.7],Heart=[count:59=pct:23.2],Thyroid=[count:47=pct:26.3],Esophagus=[count:39=pct:9.6],Spleen=[count:39=pct:34.8],Lung=[count:35=pct:21.0],Brain=[count:27=pct:4.0],Colon=[count:26=pct:13.6],Adrenal_Gland=[count:20=pct:23.5],Pituitary=[count:16=pct:30.8],Nerve=[count:15=pct:8.6],Pancreas=[count:14=pct:7.7],Prostate=[count:12=pct:19.7],Stomach=[count:12=pct:13.5],Blood=[count:12=pct:6.9],Skin=[count:11=pct:3.4],Testis=[count:10=pct:9.5],Small_Intestine=[count:10=pct:18.2],Uterus=[count:8=pct:18.6],Ovary=[count:8=pct:15.1],Breast=[count:8=pct:7.2],Whole_Blood=[count:8=pct:6.1],Liver=[count:7=pct:5.6],Salivary_Gland=[count:5=pct:12.8],Vagina=[count:5=pct:9.1],Kidney=[count:3=pct:20.0]},INTERCHROMOSOMAL[chr15--chr7]
    INS--IGF2	INS->insulin,IGF2->ArcherDX_panel,FoundationOne_panel,insulin_like_growth_factor_2,INTRACHROMOSOMAL[chr11:0.01Mb],NEIGHBORS[10176]
    TTTY15--USP9Y	TTTY15->testis-specific_transcript,_Y-linked_15_(non-protein_coding),USP9Y->ubiquitin_specific_peptidase_9,_Y-linked,INTRACHROMOSOMAL[chrY:0.01Mb],NEIGHBORS[8998]
    CEL--CELP	CEL->carboxyl_ester_lipase,CELP->carboxyl_ester_lipase_pseudogene,INTRACHROMOSOMAL[chr9:0.01Mb],NEIGHBORS[10678]


<a name='ExamineCodingEffect'></a>
## Examine Effect of Fusions on Coding Regions

It is sometimes the case that fusion transcripts generate novel fusion proteins with altered functions.  You can further explore the impact of the fusion event on coding regions by invoking the '--examine_coding_effect' parameter.

The coding effect results are appended as additional columns in the STAR-Fusion tab-delimited output file. An example set of columns include:

      #FusionName        BCR--ABL1
      ...
      CDS_LEFT_ID        ENST00000305877.8
      CDS_LEFT_RANGE     1-2782
      CDS_RIGHT_ID       ENST00000318560.5
      CDS_RIGHT_RANGE    80-3393
      PROT_FUSION_TYPE   INFRAME
      FUSION_MODEL       chr22|+|[0]23523148-23524426[0]|[1]23595986-23596167[2]|[0]23603137-23603241[2]|[0]23603542-23603727[2]|[0]23610595-23610702[2]|[0]23613719-23613779[0]|[1]23615268-23615320[2]|[0]23615821-23615961[2]|[0]23626164-23626285[1]|[2]23627220-23627388[2]|[0]23629346-23629465[2]|[0]23630284-23630359[0]|[1]23631704-23631808[0]|[1]23632526-23632600[0]<==>chr9|+|[1]133729451-133729624[0]|[1]133730188-133730483[2]|[0]133738150-133738422[2]|[0]133747516-133747600[0]|[1]133748247-133748424[1]|[2]133750255-133750439[0]|[1]133753802-133753954[0]|[1]133755455-133755544[0]|[1]133755887-133756051[0]|[1]133759356-133761070[2]
      FUSION_CDS         atggtggacccggtgggcttcgcggaggcgtggaaggcgcagttcccggactcagagcccccgcgcatggagctgcgctcagtgggcgacatcgagcaggagctggagcgctgcaaggcctccattcggcgcctggagcaggaggtgaaccaggagcgcttccgcatgatctacctgcagacgttgctggccaaggaaaagaagagctatgaccggcagcgatggggcttccggcgcgcggcgcaggcccccgacggcgcctccgagccccgagcgtccgcgtcgcgcccgcagccagcgcccgccgacggagccgacccgccgcccgccgaggagcccgaggcccggcccgacggcgagggttctccgggtaaggccaggcccgggaccgcccgcaggcccggggcagccgcgtcgggggaacgggacgaccggggaccccccgccagcgtggcggcgctcaggtccaacttcgagcggatccgcaagggccatggccagcccggggcggacgccgagaagcccttctacgtgaacgtcgagtttcaccacgagcgcggcctggtgaaggtcaacgacaaagaggtgtcggaccgcatcagctccctgggcagccaggccatgcagatggagcgcaaaaagtcccagcacggcgcgggctcgagcgtgggggatgcatccaggcccccttaccggggacgctcctcggagagcagctgcggcgtcgacggcgactacgaggacgccgagttgaacccccgcttcctgaaggacaacctgatcgacgccaatggcggtagcaggcccccttggccgcccctggagtaccagccctaccagagcatctacgtcgggggcatgatggaaggggagggcaagggcccgctcctgcgcagccagagcacctctgagcaggagaagcgccttacctggccccgcaggtcctactccccccggagttttgaggattgcggaggcggctataccccggactgcagctccaatgagaacctcacctccagcgaggaggacttctcctctggccagtccagccgcgtgtccccaagccccaccacctaccgcatgttccgggacaaaagccgctctccctcgcagaactcgcaacagtccttcgacagcagcagtccccccacgccgcagtgccataagcggcaccggcactgcccggttgtcgtgtccgaggccaccatcgtgggcgtccgcaagaccgggcagatctggcccaacgatggcgagggcgccttccatggagacgcagatggctcgttcggaacaccacctggatacggctgcgctgcagaccgggcagaggagcagcgccggcaccaagatgggctgccctacattgatgactcgccctcctcatcgccccacctcagcagcaagggcaggggcagccgggatgcgctggtctcgggagccctggagtccactaaagcgagtgagctggacttggaaaagggcttggagatgagaaaatgggtcctgtcgggaatcctggctagcgaggagacttacctgagccacctggaggcactgctgctgcccatgaagcctttgaaagccgctgccaccacctctcagccggtgctgacgagtcagcagatcgagaccatcttcttcaaagtgcctgagctctacgagatccacaaggagttctatgatgggctcttcccccgcgtgcagcagtggagccaccagcagcgggtgggcgacctcttccagaagctggccagccagctgggtgtgtaccgggccttcgtggacaactacggagttgccatggaaatggctgagaagtgctgtcaggccaatgctcagtttgcagaaatctccgagaacctgagagccagaagcaacaaagatgccaaggatccaacgaccaagaactctctggaaactctgctctacaagcctgtggaccgtgtgacgaggagcacgctggtcctccatgacttgctgaagcacactcctgccagccaccctgaccaccccttgctgcaggacgccctccgcatctcacagaacttcctgtccagcatcaatgaggagatcacaccccgacggcagtccatgacggtgaagaagggagagcaccggcagctgctgaaggacagcttcatggtggagctggtggagggggcccgcaagctgcgccacgtcttcctgttcaccgacctgcttctctgcaccaagctcaagaagcagagcggaggcaaaacgcagcagtatgactgcaaatggtacattccgctcacggatctcagcttccagatggtggatgaactggaggcagtgcccaacatccccctggtgcccgatgaggagctggacgctttgaagatcaagatctcccagatcaagaatgacatccagagagagaagagggcgaacaagggcagcaaggctacggagaggctgaagaagaagctgtcggagcaggagtcactgctgctgcttatgtctcccagcatggccttcagggtgcacagccgcaacggcaagagttacacgttcctgatctcctctgactatgagcgtgcagagtggagggagaacatccgggagcagcagaagaagtgtttcagaagcttctccctgacatccgtggagctgcagatgctgaccaactcgtgtgtgaaactccagactgtccacagcattccgctgaccatcaataaggaagatgatgagtctccggggctctatgggtttctgaatgtcatcgtccactcagccactggatttaagcagagttcaaAAGCCCTTCAGCGGCCAGTAGCATCTGACTTTGAGCCTCAGGGTCTGAGTGAAGCCGCTCGTTGGAACTCCAAGGAAAACCTTCTCGCTGGACCCAGTGAAAATGACCCCAACCTTTTCGTTGCACTGTATGATTTTGTGGCCAGTGGAGATAACACTCTAAGCATAACTAAAGGTGAAAAGCTCCGGGTCTTAGGCTATAATCACAATGGGGAATGGTGTGAAGCCCAAACCAAAAATGGCCAAGGCTGGGTCCCAAGCAACTACATCACGCCAGTCAACAGTCTGGAGAAACACTCCTGGTACCATGGGCCTGTGTCCCGCAATGCCGCTGAGTATCTGCTGAGCAGCGGGATCAATGGCAGCTTCTTGGTGCGTGAGAGTGAGAGCAGTCCTGGCCAGAGGTCCATCTCGCTGAGATACGAAGGGAGGGTGTACCATTACAGGATCAACACTGCTTCTGATGGCAAGCTCTACGTCTCCTCCGAGAGCCGCTTCAACACCCTGGCCGAGTTGGTTCATCATCATTCAACGGTGGCCGACGGGCTCATCACCACGCTCCATTATCCAGCCCCAAAGCGCAACAAGCCCACTGTCTATGGTGTGTCCCCCAACTACGACAAGTGGGAGATGGAACGCACGGACATCACCATGAAGCACAAGCTGGGCGGGGGCCAGTACGGGGAGGTGTACGAGGGCGTGTGGAAGAAATACAGCCTGACGGTGGCCGTGAAGACCTTGAAGGAGGACACCATGGAGGTGGAAGAGTTCTTGAAAGAAGCTGCAGTCATGAAAGAGATCAAACACCCTAACCTGGTGCAGCTCCTTGGGGTCTGCACCCGGGAGCCCCCGTTCTATATCATCACTGAGTTCATGACCTACGGGAACCTCCTGGACTACCTGAGGGAGTGCAACCGGCAGGAGGTGAACGCCGTGGTGCTGCTGTACATGGCCACTCAGATCTCGTCAGCCATGGAGTACCTGGAGAAGAAAAACTTCATCCACAGAGATCTTGCTGCCCGAAACTGCCTGGTAGGGGAGAACCACTTGGTGAAGGTAGCTGATTTTGGCCTGAGCAGGTTGATGACAGGGGACACCTACACAGCCCATGCTGGAGCCAAGTTCCCCATCAAATGGACTGCACCCGAGAGCCTGGCCTACAACAAGTTCTCCATCAAGTCCGACGTCTGGGCATTTGGAGTATTGCTTTGGGAAATTGCTACCTATGGCATGTCCCCTTACCCGGGAATTGACCTGTCCCAGGTGTATGAGCTGCTAGAGAAGGACTACCGCATGGAGCGCCCAGAAGGCTGCCCAGAGAAGGTCTATGAACTCATGCGAGCATGTTGGCAGTGGAATCCCTCTGACCGGCCCTCCTTTGCTGAAATCCACCAAGCCTTTGAAACAATGTTCCAGGAATCCAGTATCTCAGACGAAGTGGAAAAGGAGCTGGGGAAACAAGGCGTCCGTGGGGCTGTGAGTACCTTGCTGCAGGCCCCAGAGCTGCCCACCAAGACGAGGACCTCCAGGAGAGCTGCAGAGCACAGAGACACCACTGACGTGCCTGAGATGCCTCACTCCAAGGGCCAGGGAGAGAGCGATCCTCTGGACCATGAGCCTGCCGTGTCTCCATTGCTCCCTCGAAAAGAGCGAGGTCCCCCGGAGGGCGGCCTGAATGAAGATGAGCGCCTTCTCCCCAAAGACAAAAAGACCAACTTGTTCAGCGCCTTGATCAAGAAGAAGAAGAAGACAGCCCCAACCCCTCCCAAACGCAGCAGCTCCTTCCGGGAGATGGACGGCCAGCCGGAGCGCAGAGGGGCCGGCGAGGAAGAGGGCCGAGACATCAGCAACGGGGCACTGGCTTTCACCCCCTTGGACACAGCTGACCCAGCCAAGTCCCCAAAGCCCAGCAATGGGGCTGGGGTCCCCAATGGAGCCCTCCGGGAGTCCGGGGGCTCAGGCTTCCGGTCTCCCCACCTGTGGAAGAAGTCCAGCACGCTGACCAGCAGCCGCCTAGCCACCGGCGAGGAGGAGGGCGGTGGCAGCTCCAGCAAGCGCTTCCTGCGCTCTTGCTCCGCCTCCTGCGTTCCCCATGGGGCCAAGGACACGGAGTGGAGGTCAGTCACGCTGCCTCGGGACTTGCAGTCCACGGGAAGACAGTTTGACTCGTCCACATTTGGAGGGCACAAAAGTGAGAAGCCGGCTCTGCCTCGGAAGAGGGCAGGGGAGAACAGGTCTGACCAGGTGACCCGAGGCACAGTAACGCCTCCCCCCAGGCTGGTGAAAAAGAATGAGGAAGCTGCTGATGAGGTCTTCAAAGACATCATGGAGTCCAGCCCGGGCTCCAGCCCGCCCAACCTGACTCCAAAACCCCTCCGGCGGCAGGTCACCGTGGCCCCTGCCTCGGGCCTCCCCCACAAGGAAGAAGCTGGAAAGGGCAGTGCCTTAGGGACCCCTGCTGCAGCTGAGCCAGTGACCCCCACCAGCAAAGCAGGCTCAGGTGCACCAGGGGGCACCAGCAAGGGCCCCGCCGAGGAGTCCAGAGTGAGGAGGCACAAGCACTCCTCTGAGTCGCCAGGGAGGGACAAGGGGAAATTGTCCAGGCTCAAACCTGCCCCGCCGCCCCCACCAGCAGCCTCTGCAGGGAAGGCTGGAGGAAAGCCCTCGCAGAGCCCGAGCCAGGAGGCGGCCGGGGAGGCAGTCCTGGGCGCAAAGACAAAAGCCACGAGTCTGGTTGATGCTGTGAACAGTGACGCTGCCAAGCCCAGCCAGCCGGGAGAGGGCCTCAAAAAGCCCGTGCTCCCGGCCACTCCAAAGCCACAGTCCGCCAAGCCGTCGGGGACCCCCATCAGCCCAGCCCCCGTTCCCTCCACGTTGCCATCAGCATCCTCGGCCCTGGCAGGGGACCAGCCGTCTTCCACCGCCTTCATCCCTCTCATATCAACCCGAGTGTCTCTTCGGAAAACCCGCCAGCCTCCAGAGCGGATCGCCAGCGGCGCCATCACCAAGGGCGTGGTCCTGGACAGCACCGAGGCGCTGTGCCTCGCCATCTCTAGGAACTCCGAGCAGATGGCCAGCCACAGCGCAGTGCTGGAGGCCGGCAAAAACCTCTACACGTTCTGCGTGAGCTATGTGGATTCCATCCAGCAAATGAGGAACAAGTTTGCCTTCCGAGAGGCCATCAACAAACTGGAGAATAATCTCCGGGAGCTTCAGATCTGCCCGGCGACAGCAGGCAGTGGTCCAGCGGCCACTCAGGACTTCAGCAAGCTCCTCAGTTCGGTGAAGGAAATCAGTGACATAGTGCAGAGGTAG
      FUSION_TRANSL      MVDPVGFAEAWKAQFPDSEPPRMELRSVGDIEQELERCKASIRRLEQEVNQERFRMIYLQTLLAKEKKSYDRQRWGFRRAAQAPDGASEPRASASRPQPAPADGADPPPAEEPEARPDGEGSPGKARPGTARRPGAAASGERDDRGPPASVAALRSNFERIRKGHGQPGADAEKPFYVNVEFHHERGLVKVNDKEVSDRISSLGSQAMQMERKKSQHGAGSSVGDASRPPYRGRSSESSCGVDGDYEDAELNPRFLKDNLIDANGGSRPPWPPLEYQPYQSIYVGGMMEGEGKGPLLRSQSTSEQEKRLTWPRRSYSPRSFEDCGGGYTPDCSSNENLTSSEEDFSSGQSSRVSPSPTTYRMFRDKSRSPSQNSQQSFDSSSPPTPQCHKRHRHCPVVVSEATIVGVRKTGQIWPNDGEGAFHGDADGSFGTPPGYGCAADRAEEQRRHQDGLPYIDDSPSSSPHLSSKGRGSRDALVSGALESTKASELDLEKGLEMRKWVLSGILASEETYLSHLEALLLPMKPLKAAATTSQPVLTSQQIETIFFKVPELYEIHKEFYDGLFPRVQQWSHQQRVGDLFQKLASQLGVYRAFVDNYGVAMEMAEKCCQANAQFAEISENLRARSNKDAKDPTTKNSLETLLYKPVDRVTRSTLVLHDLLKHTPASHPDHPLLQDALRISQNFLSSINEEITPRRQSMTVKKGEHRQLLKDSFMVELVEGARKLRHVFLFTDLLLCTKLKKQSGGKTQQYDCKWYIPLTDLSFQMVDELEAVPNIPLVPDEELDALKIKISQIKNDIQREKRANKGSKATERLKKKLSEQESLLLLMSPSMAFRVHSRNGKSYTFLISSDYERAEWRENIREQQKKCFRSFSLTSVELQMLTNSCVKLQTVHSIPLTINKEDDESPGLYGFLNVIVHSATGFKQSSKALQRPVASDFEPQGLSEAARWNSKENLLAGPSENDPNLFVALYDFVASGDNTLSITKGEKLRVLGYNHNGEWCEAQTKNGQGWVPSNYITPVNSLEKHSWYHGPVSRNAAEYLLSSGINGSFLVRESESSPGQRSISLRYEGRVYHYRINTASDGKLYVSSESRFNTLAELVHHHSTVADGLITTLHYPAPKRNKPTVYGVSPNYDKWEMERTDITMKHKLGGGQYGEVYEGVWKKYSLTVAVKTLKEDTMEVEEFLKEAAVMKEIKHPNLVQLLGVCTREPPFYIITEFMTYGNLLDYLRECNRQEVNAVVLLYMATQISSAMEYLEKKNFIHRDLAARNCLVGENHLVKVADFGLSRLMTGDTYTAHAGAKFPIKWTAPESLAYNKFSIKSDVWAFGVLLWEIATYGMSPYPGIDLSQVYELLEKDYRMERPEGCPEKVYELMRACWQWNPSDRPSFAEIHQAFETMFQESSISDEVEKELGKQGVRGAVSTLLQAPELPTKTRTSRRAAEHRDTTDVPEMPHSKGQGESDPLDHEPAVSPLLPRKERGPPEGGLNEDERLLPKDKKTNLFSALIKKKKKTAPTPPKRSSSFREMDGQPERRGAGEEEGRDISNGALAFTPLDTADPAKSPKPSNGAGVPNGALRESGGSGFRSPHLWKKSSTLTSSRLATGEEEGGGSSSKRFLRSCSASCVPHGAKDTEWRSVTLPRDLQSTGRQFDSSTFGGHKSEKPALPRKRAGENRSDQVTRGTVTPPPRLVKKNEEAADEVFKDIMESSPGSSPPNLTPKPLRRQVTVAPASGLPHKEEAGKGSALGTPAAAEPVTPTSKAGSGAPGGTSKGPAEESRVRRHKHSSESPGRDKGKLSRLKPAPPPPPAASAGKAGGKPSQSPSQEAAGEAVLGAKTKATSLVDAVNSDAAKPSQPGEGLKKPVLPATPKPQSAKPSGTPISPAPVPSTLPSASSALAGDQPSSTAFIPLISTRVSLRKTRQPPERIASGAITKGVVLDSTEALCLAISRNSEQMASHSAVLEAGKNLYTFCVSYVDSIQQMRNKFAFREAINKLENNLRELQICPATAGSGPAATQDFSKLLSSVKEISDIVQR*
      PFAM_LEFT          Bcr-Abl_Oligo|3-75|3.6e-43^RhoGEF|503-689|1.1e-37^IQ_SEC7_PH|724-769|4.7e-06^PH_5|727-865|6.6e-05^PH|740-864|5.3e-06^Bcr-Abl_Oligo|781-802|0.45^C2|913-1007|2.2e-09^PH|919-973|0.56^RhoGAP|1068-1218|7.9e-52
      PFAM_RIGHT         SH3_1-PARTIAL|~80-113|1.6e-15^SH3_9-PARTIAL|~80-117|1.3e-11^SH3_2-PARTIAL|~80-118|1.9e-10^SH3_3|82-116|9.2e-08^SH3_6|83-112|0.00021^SH2|127-202|1.4e-26^Pkinase_Tyr|242-492|3.3e-102^Pkinase|244-491|2.1e-51^Haspin_kinase|307-388|9.1e-07^F_actin_bind|1027-1130|2.2e-33


>Note, fusion annotation and examination of coding effects are additionally performed on FusionInspector outputs if '--FusionInspector inspect|validate' is invoked in your STAR-Fusion run.


<a name='TrinityReconstruct'>
## De novo reconstruct fusion transcripts using Trinity

The reconstructed transcripts described above by the 'fusion coding effect' module are based on the reference annotations and the reference genome sequence.  If you're interested in doing de novo reconstruction of fusion transcripts based on the actual fusion-supporting RNA-Seq reads, capturing any additional variant information or novel sequence features that may be evidence among the reads, you can include de novo reconstruction by invoking the STAR-Fusion '--denovo_reconstruct' parameter.  This requires that you include the  '--FusionInspector inspect|validate' setting.  Based on the STAR-Fusion predicted fusions.  

[Trinity](http://trinityrnaseq.github.io) is used to assemble reads aligned to fusion contigs constructed by FusionInspector.  If FusionInspector 'inspect' mode is invoked, then only the fusion-evidence reads are de novo assembled.  If FusionInspector 'validate' mode is selected, then all reads aligned to the fusion gene contigs are assembled.  Trinity contigs identified as fusion transcripts via our included [GMAP-fusion](https://github.com/GMAP-fusion/GMAP-fusion/wiki) utility are captured and reported.  The de novo reconstructed fusion transcripts are provided as a FASTA file '${star_fusion_output_directory}/FusionInspector/finspector.gmap_trinity_GG.fusions.fasta', and the transcript accessions are reported in the FusionInspector tab-delimited summary output file.

An example Trinity-reconstructed fusion transcript is:

    >TRINITY_GG_12_c0_g1_i1 VAPB--IKZF3:1396-28254
    CGGTGTCTGGACCAAGGGGCGCAGGGCTTCGGCGCCAAGATAGCTGATGGCGTTATTGATGGCTTGGTCCATCATGCGGG
    TCTGTATGAGCTCACTCTCTTTCTCATACATGTAACTTGAATTATAGTTGACATCAAAGCAGTGGCGCTTCTCACCAATG
    AATTTCTGAGGCATTGAGCTTTTTCGTTTTGCCACATTGCTTGCTAATCTGTCCAGTACGAGAGCTCTTTCACTTCCCAT
    CTCTGCTTTGATGTGTCTTGCCTCCGCACTTGCTCGGAATTTGAGCTCGTGCTGCGGCTCGAGGCTCAGGACCTGCTCCA
    CCTTCGCCATGTTCCTTAGCGGCGGAGCACCTTTGGCGGGGAGACCCCTGAGAGGTCACCGGGGCGGGAAGCGTTAATGC
    TGCGCCCGCTTTAAGTTTTACAAAAAGGCGGGGACCGGTCGGGGCACGGGCGGGGGTCCTCTACCG

See our [FusionInspector wiki](https://github.com/FusionInspector/FusionInspector/wiki) for more details.

<a name='ExampleData'></a>
## Example data and execution:

In the included testing/ directory, you'll find a small sample of fastq reads from a tumor sample.  Find fusions using the resource set like so:

    cd testing/
     
    ../STAR-Fusion --left_fq reads_1.fq.gz --right_fq reads_2.fq.gz \
                   -O star_fusion_outdir \
                   --genome_lib_dir  /path/to/your/CTAT_resource_lib \
                   --verbose_level 2  


<a name='Docker'></a>
## Want to use Docker?

We provide a Docker image that contains all software pre-installed for running STAR, STAR-Fusion, and FusionInspector, and it's available here: https://hub.docker.com/r/trinityctat/ctatfusion/

If you have docker installed, you can pull the image like so:

    docker pull trinityctat/ctatfusion

STAR-Fusion could be run like so via Docker, for example, running within the '${STAR_FUSION_HOME}/Docker' folder, where ${STAR_FUSION_HOME} is your base installation directory for the STAR-Fusion software.

    # setting some targets
    VERSION=1.1.0
    CTAT_GENOME_LIB="GRCh37_gencode_v19_CTAT_lib_July192017"
    CTAT_GENOME_LIB_URL="https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/${CTAT_GENOME_LIB}.plug-n-play.tar.gz"

    # pulling down the plug-n-play version of the CTAT genome lib:
    wget ${CTAT_GENOME_LIB_URL} -O ../${CTAT_GENOME_LIB}.tar.gz

    # unpacking it
    tar xvf ../${CTAT_GENOME_LIB}.tar.gz -C ../.

    # and now running STAR-Fusion & FusionInspector 'inspect' & Trinity de-novo reconstruction via Docker:
    docker run -v `pwd`/../:/data --rm trinityctat/ctatfusion:${VERSION} \
        /usr/local/src/STAR-Fusion_v${VERSION}/STAR-Fusion \
        --left_fq /data/testing/reads_1.fq.gz \
        --right_fq /data/testing/reads_2.fq.gz \
        --genome_lib_dir /data/${CTAT_GENOME_LIB}/ctat_genome_lib_build_dir \
        -O /data/testing/test_docker_outdir/StarFusionOut \
        --FusionInspector inspect \
        --annotate \
        --examine_coding_effect \
        --denovo_reconstruct


<a name='ContactUs'></a>
## Contact Us

Questions, comments, etc?

Visit our STAR-fusion Google group <https://groups.google.com/forum/#!forum/star-fusion>

## Acknowledgements

This effort was largely inspired by earlier work done by Nicolas Stransky in the landmark publication "The landscape of kinase fusions in cancer" by [Stransky et al., Nat Commun 2014](http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4175590/), in addition to very nice work done by Daniel Nicorici with his [FusionCatcher software](http://biorxiv.org/content/early/2014/11/19/011650).

STAR-Fusion is contributed by Brian Haas (@Broad Institute), in collaboration with Alex Dobin (@CSHL).

